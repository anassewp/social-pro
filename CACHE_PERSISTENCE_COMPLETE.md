# โ ุงูุชูุงู ูุธุงู Cache Persistence

## ๐ ููุฎุต ุงูุชุทุจูู

ุชู ุชุทุจูู ูุธุงู **Cache Persistence** ุจูุฌุงุญ ููุจูุงูุงุช ุงููููุฉ ุจุงุณุชุฎุฏุงู `localStorage`.

---

## ๐ฏ ุงูููุฒุงุช ุงูููููุฐุฉ

### 1. โ Cache Persistence Manager
**ุงูููู:** `src/lib/cache/persistence.ts`

**ุงูููุฒุงุช:**
- ุญูุธ cache ูุฏููุงู ูู localStorage
- ุงุณุชุนุงุฏุฉ cache ุชููุงุฆูุงู ุนูุฏ ุชุญููู ุงูุตูุญุฉ
- ูุธุงู Backup ุชููุงุฆู
- ุชูุธูู ุชููุงุฆู ููุจูุงูุงุช ุงููุฏููุฉ
- ุงูุชุญูู ูู ุงูุฅุตุฏุงุฑ ูุนูุฑ ุงูุจูุงูุงุช
- ุฅุฏุงุฑุฉ ุญุฌู Cache (max 5MB)

### 2. โ ุงูุชูุงูู ูุน QueryProvider
**ุงูููู:** `src/lib/providers/QueryProvider.tsx`

**ุงูููุฒุงุช:**
- ุงุณุชุนุงุฏุฉ Cache ุชููุงุฆูุงู ุนูุฏ mount
- ุญูุธ Cache ุชููุงุฆูุงู ุนูุฏ ุชุญุฏูุซ ุงูุจูุงูุงุช
- ุญูุธ Cache ูุจู ุฅุบูุงู ุงูุตูุญุฉ
- ุญูุธ Cache ุฏูุฑู (ูู 30 ุซุงููุฉ)
- ุชูุธูู ุชููุงุฆู ููุจูุงูุงุช ุงููุฏููุฉ

### 3. โ ุงูุชูุงูู ูุน Cache Manager
**ุงูููู:** `src/lib/cache/cache-manager.ts`

**ุงูููุฒุงุช:**
- ูุณุญ localStorage ุนูุฏ invalidate table
- ูุณุญ localStorage ุนูุฏ invalidate all
- ุชูุธูู localStorage ุนูุฏ clear expired cache

---

## ๐ ุงูุจูุงูุงุช ุงููุญููุธุฉ

ุงูุจูุงูุงุช ุงูุชุงููุฉ ุชูุญูุธ ุชููุงุฆูุงู ูู localStorage:
- โ **Groups** (ุงููุฌููุนุงุช)
- โ **Campaigns** (ุงูุญููุงุช)
- โ **Team** (ูุนูููุงุช ุงููุฑูู)
- โ **Members** (ุงูุฃุนุถุงุก)

**ููุงุญุธุฉ:** ุงูุฌูุณุงุช ู Dashboard stats ูุง ุชูุญูุธ (ุจูุงูุงุช ูุชุบูุฑุฉ ุฌุฏุงู)

---

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช

```typescript
PERSISTENCE_CONFIG = {
  STORAGE_KEY: 'socialpro-query-cache',
  BACKUP_KEY: 'socialpro-query-cache-backup',
  MAX_AGE: 7 * 24 * 60 * 60 * 1000, // 7 ุฃูุงู
  VERSION: process.env.NEXT_PUBLIC_APP_VERSION || '1.0.0',
  MAX_SIZE: 5 * 1024 * 1024, // 5MB
}
```

---

## ๐ ุขููุฉ ุงูุนูู

### ุนูุฏ ุชุญููู ุงูุตูุญุฉ:
1. ุชูุธูู cache ุงููุฏูู ุฅุฐุง ูุฒู ุงูุฃูุฑ
2. ุงุณุชุนุงุฏุฉ cache ูู localStorage
3. ุนุฑุถ ุงูุจูุงูุงุช ููุฑุงู (ุฅุฐุง ูุงูุช ููุฌูุฏุฉ)
4. ุชุญุฏูุซ ุงูุจูุงูุงุช ูู ุงูุฎูููุฉ

### ุนูุฏ ุชุญุฏูุซ ุงูุจูุงูุงุช:
1. ุชุญุฏูุซ cache ูู memory
2. ุญูุธ cache ูู localStorage (debounced ูู 2 ุซุงููุฉ)
3. ุญูุธ backup ุชููุงุฆูุงู ูุจู ุงูุญูุธ

### ุนูุฏ ุฅุบูุงู ุงูุตูุญุฉ:
1. ุญูุธ cache ููุงุฆู ูู localStorage
2. ุญูุธ backup ููุณุฎุฉ ุงุญุชูุงุทูุฉ

### ุงูุชูุธูู ุงูุชููุงุฆู:
- ุฅุฐุง ุชุฌุงูุฒ ุญุฌู cache 5MBุ ูุชู ุญุฐู ุฃูุฏู 50% ูู ุงูุจูุงูุงุช
- ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุฃูุฏู ูู 7 ุฃูุงูุ ูุชู ุญุฐููุง ุชููุงุฆูุงู
- ุฅุฐุง ุชุบูุฑ ุฅุตุฏุงุฑ ุงูุชุทุจููุ ูุชู ูุณุญ cache ุงููุฏูู

---

## ๐๏ธ ุงูุงุณุชุฎุฏุงู ุงููุฏูู

### ุญูุธ cache ูุฏููุงู:
```typescript
import { CachePersistenceManager } from '@/lib/cache/persistence'
import { useQueryClient } from '@tanstack/react-query'

const queryClient = useQueryClient()
CachePersistenceManager.saveCache(queryClient)
```

### ุงุณุชุนุงุฏุฉ cache ูุฏููุงู:
```typescript
CachePersistenceManager.restoreCache(queryClient)
```

### ูุณุญ cache ูุฌุฏูู ูุนูู:
```typescript
CachePersistenceManager.clearTableCache('campaigns')
```

### ุงูุญุตูู ุนูู ูุนูููุงุช cache:
```typescript
const info = CachePersistenceManager.getCacheInfo()
console.log('Cache size:', info.size)
console.log('Query count:', info.queryCount)
console.log('Timestamp:', info.timestamp)
console.log('Version:', info.version)
```

### ูุณุญ ุฌููุน cache:
```typescript
CachePersistenceManager.clearCache()
```

---

## โ ุงูููุงุฆุฏ

1. **ุฃุฏุงุก ุฃูุถู**: ุงูุจูุงูุงุช ุชุธูุฑ ููุฑุงู ุจุฏูู ุงูุชุธุงุฑ ุทูุจุงุช ุงูุดุจูุฉ
2. **ุชุฌุฑุจุฉ offline**: ุฅููุงููุฉ ุนุฑุถ ุงูุจูุงูุงุช ุงููุญููุธุฉ ุญุชู ุจุฏูู ุงุชุตุงู
3. **ุชูููู ุงุณุชุฏุนุงุกุงุช API**: ุชูููู ุงูุญูู ุนูู ุงูุฎุงุฏู
4. **ุงุณุชุนุงุฏุฉ ุณุฑูุนุฉ**: ุงูุจูุงูุงุช ูุชุงุญุฉ ููุฑุงู ุนูุฏ ุฅุนุงุฏุฉ ูุชุญ ุงูุตูุญุฉ

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุฎุตูุตูุฉ**: ุงูุจูุงูุงุช ูุญููุธุฉ ูุญููุงู ูู ูุชุตูุญ ุงููุณุชุฎุฏู ููุท
2. **ุงูุญุฌู**: ูุธุงู ุชูุธูู ุชููุงุฆู ูููุน ุงูุชูุงุก localStorage
3. **ุงููุณุฎ ุงูุงุญุชูุงุทู**: ูุธุงู backup ุชููุงุฆู ูุญูุงูุฉ ุงูุจูุงูุงุช
4. **ุงูุชุญุฏูุซุงุช**: ุงูุชุญูู ูู ุงูุฅุตุฏุงุฑ ูุถูุงู ุชูุงูู ุงูุจูุงูุงุช

---

## ๐ ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุงูุญูุธ:
```typescript
// 1. ุงูุชุญ ุฃู ุตูุญุฉ (ูุซู /groups)
// 2. ุงูุชุญ DevTools > Application > Local Storage
// 3. ุงุจุญุซ ุนู 'socialpro-query-cache'
// 4. ูุฌุจ ุฃู ุชุฌุฏ ุงูุจูุงูุงุช ูุญููุธุฉ
```

### ุงุฎุชุจุงุฑ ุงูุงุณุชุนุงุฏุฉ:
```typescript
// 1. ุงูุชุญ ุตูุญุฉ (ูุซู /campaigns)
// 2. ุฃุบูู ุงููุชุตูุญ
// 3. ุงูุชุญ ุงููุชุตูุญ ูุฑุฉ ุฃุฎุฑู
// 4. ุงูุชุญ ููุณ ุงูุตูุญุฉ
// 5. ูุฌุจ ุฃู ุชุธูุฑ ุงูุจูุงูุงุช ููุฑุงู ูู cache
// 6. ุซู ูุชู ุชุญุฏูุซูุง ูู ุงูุฎุงุฏู ูู ุงูุฎูููุฉ
```

### ุงุฎุชุจุงุฑ ุงูุชูุธูู:
```typescript
// 1. ุงุณุชุฎุฏู getCacheInfo() ููุนุฑูุฉ ุญุฌู cache
// 2. ุฅุฐุง ุชุฌุงูุฒ 5MBุ ุณูุชู ุงูุชูุธูู ุชููุงุฆูุงู
```

---

## โ ุงูุญุงูุฉ

- โ Build ูุงุฌุญ
- โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก TypeScript
- โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก Linting
- โ ุงูุชูุงูู ููุชูู ูุน QueryProvider
- โ ุงูุชูุงูู ููุชูู ูุน Cache Manager

---

**ุชุงุฑูุฎ ุงูุฅููุงู:** ุงูุขู โ  
**ุงูุญุงูุฉ:** ููุชูู 100% โ

